<!DOCTYPE html>
<html lang="en" ng-app="app">
<head>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.8/angular.min.js"></script>
	<script src="https://code.angularjs.org/1.5.8/angular-route.js"></script>
	<script>
		var app = angular.module('app', ['ngRoute']);

		app.controller('HomeController', function($http, $scope){
			var vm = this;
			vm.jobs = [];

			vm.saveJob = function(job){
				console.log(job);
				if(job){
					$http.put('/api/jobs', job).then(function(res){
						console.log(res);
						vm.getCurrentJobs();
					})
				}
			}

			vm.deleteJob = function(job){
				$http.delete('/api/jobs/' +  job._id).then(function(response){
					console.log('has been deelted');
					vm.getCurrentJobs();
				})
			}

			vm.addJob = function(job){
				
					$http.post('/api/jobs', job).then(function(res){
						vm.model = '';
						console.log(res);
						
					})
					vm.getCurrentJobs();
			}

			vm.getCurrentJobs = function()
			{
				$http.get('/api/jobs').then(function(response){
					vm.jobs = response.data;
				})
			}
			vm.getCurrentJobs();
			vm.title = "Angular Scheduler";
		});

		app.config(function($routeProvider){
			$routeProvider.when('/', {
				controller: 'HomeController',
				controllerAs: 'vm',
				templateUrl: './home.html'
			});
			$routeProvider.otherwise('/');
		})


	</script>
	<meta charset="UTF-8">
	<title>Angular Scheduler</title>
</head>
<body>
	<div class="container">
		<div ng-view></div>
	</div>
</body>
</html>